{
  // Version of the syntax for this checker.
  "version": "1.0",
  // The name of the checker as to appear in Coverity defects
  "name": "METRICS.TOO_COMPLEX",
  // A short and generic descrption of the checker purpose
  "description": "Detects functions with both a Line of code and a Cyclomatic Complexity above a threshold",
  // The list of the metrics in Coverity with their associated default tresholds
  "thresholds": [
    {
      // The name of the theshold the user can adjust from the CLI
      "name" : "ccm",
      // The name of the metrics in the Coverity file FUNCTIONS.metrics.xml.gz
      "metrics": "cc",
      // The default theshold
      "threshold": 12
    },
    {
      // The name of the theshold the user can adjust from the CLI
      "name" : "loc",
      // The name of the metrics in the Coverity file FUNCTIONS.metrics.xml.gz
      "metrics": "lc",
      // The default theshold
      "threshold": 260
    }

  ],

  "defect-template": {
    "checker": "METRICS.TOO_COMPLEX",
    "extra": "metric_violation",
    "file": "${fileName}",
    "function": "${funcName}",
    "subcategory": "code_quality",
    "properties": {
      "type": "LOC & CCM too high",
      "category": "Code maintainability issues",
      "impact": "medium",
      "longDescription": "Writing large functions with too many branches is harder to maintain.",
      "localEffect": "Hard to maintain function",
      "issueKind": "QUALITY"
    },
    "events": [
      {
        "tag": "LOC & CCM metric violation",
        "file": "${fileName}",
        "linkUrl": "https://en.wikipedia.org/wiki/Cyclomatic_complexity",
        "linkText": "Wikipedia on CCM",
        "description": "The Cyclomatic Complexity Measure (MacCabe) is ${loc} which is above the threshold ${loc.threshold} and the LOC is ${loc} above ${loc.threshold}.",
        "line": 0,
        "main": true
      }
    ]
  }

}